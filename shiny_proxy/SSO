┌─────────────┐     ┌─────────────┐     ┌─────────────┐     ┌─────────────┐
│    User     │     │   Azure AD  │     │ ShinyProxy  │     │  ECS App    │
└──────┬──────┘     └──────┬──────┘     └──────┬──────┘     └──────┬──────┘
       │                   │                     │                   │
       │ 1. Access App     │                     │                   │
       ├──────────────────────────────────────►  │                   │
       │                   │                     │                   │
       │ 2. Redirect to Login                    │                   │
       │ ◄───────────────────────────────────────┤                   │
       │                   │                     │                   │
       │ 3. Login Request  │                     │                   │
       ├──────────────────►│                     │                   │
       │                   │                     │                   │
       │ 4. Auth Code      │                     │                   │
       │ ◄─────────────────┤                     │                   │
       │                   │                     │                   │
       │ 5. Return Code    │                     │                   │
       ├──────────────────────────────────────►  │                   │
       │                   │                     │                   │
       │                   │ 6. Exchange Code    │                   │
       │                   │ ◄───────────────────┤                   │
       │                   │                     │                   │
       │                   │ 7. Tokens           │                   │
       │                   ├────────────────────►│                   │
       │                   │                     │                   │
       │                   │                     │ 8. Check Container │
       │                   │                     ├──────────────────►│
       │                   │                     │                   │
       │                   │                     │ 9a. Pre-init:     │
       │                   │                     │    HTTP Headers   │
       │                   │                     ├──────────────────►│
       │                   │                     │                   │
       │                   │                     │ 9b. On-demand:    │
       │                   │                     │    Create + Env   │
       │                   │                     ├──────────────────►│
       │                   │                     │                   │
       │ 10. App Response  │                     │                   │
       │ ◄───────────────────────────────────────┤◄──────────────────┤
